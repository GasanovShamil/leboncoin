<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
  <title>leboncoin Challenge</title>

  <!-- CSS  -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  
</head>
<body>
  <nav class="orange" role="navigation">
    <div class="nav-wrapper container"><a id="logo-container" href="#" class="brand-logo">leboncoin Challenge</a>
      
      
      <ul class="right hide-on-med-and-down">
        <li><a href="#">. . .</a></li>
      </ul>

      <ul id="nav-mobile" class="sidenav">
        <li><a href="#">leboncoin Menu</a></li>
      </ul>
      <a href="#" data-target="nav-mobile" class="sidenav-trigger"><i class="material-icons">menu</i></a>
    </div>
  </nav>
  <div class="section no-pad-bot" id="index-banner">
    <div class="container">
      <br><br>
      <h4 class="header center orange-text">Submit your offer</h1>
      <div class="row center">
        <h5 class="header col s12 light">You are ...</h5>
        <form action="#">
          <p>
            <label>
              <input class="with-gap" name="group1" type="radio" />
              <span>A professional</span>
            </label>
            <label>
              <input class="with-gap" name="group1" type="radio" />
              <span>An individual</span>
            </label>
          </p>

          <div class="row center">
      <div id="drop-area">
          <form class="my-form">
            <p>Upload multiple files with the file dialog or by dragging and dropping images onto the dashed region</p>
            <input type="file" id="photos-input" multiple accept="image/*" onchange="handleFiles(this.files)">
            <label class="button" for="photos-input">Select some files</label>
            <br><br><button  id="upload-button">Upload</button>
          </form>
          <progress id="progress-bar" max=100 value=0></progress>
         
          <div id="gallery" /></div>
        </div>
      
      
          </div> 
        
          <div class="row">
              <form class="col s12"> 
                    <div class="input-field col s12">
                        <select id = "select1">
                            <option disable value="Opt">Select category</option>
                          <optgroup label="Vehicules"> 
                            <option value="Voiture">Voiture</option>
                            <option value="Moto">Moto</option>
                          </optgroup>
                          <optgroup label="Multimedia">
                            <option value="Technology">Technology</option>
                            <option value="Videogames">Videogames</option>
                            <option value="Cellular">Cellular</option>
                            <option value="Imagery">Imagery</option>
                          </optgroup>
                        </select>
                        <label>Category</label>
                      </div> 
                </div>
              </form>
              </div>
              <div class="row">
                  <form class="col s12">
                    <div class="row">
                      <div class="input-field col s12">
                        <textarea id="textarea1" class="materialize-textarea"></textarea>
                        <label for="textarea1">What are you selling ?</label>
                      </div>
                    </div>
                    <div class="row">
                        <div class="input-field col s12">
                          <textarea id="textarea2" class="materialize-textarea"></textarea>
                          <label for="textarea2">Description</label>
                        </div>  
                      </div>
                    <div class="row">
                      <div class="input-field col s2">
                          <input type = "number" id="Prix" type="text" class="validate">
                          <label for="Prix">â‚¬ Price</label> 
                        </div>
                        <a href="#!" id="download-button" class="btn-large waves-effect waves-light orange" >Suggestion</a>
					 </div>
                  </form>
                </div>
      <div class="row center">
        
      </div>
      <br><br>

    </div>
  </div>


  <div class="container">
    <div class="section">

      <!--   Icon Section   -->
      <div class="row">
        <div class="col s12 m4">
          <div class="icon-block">
            <h2 class="center light-blue-text"><i class="material-icons">flash_on</i></h2>
            <h5 class="center">Speeds up selling process</h5>

            <p class="light">We just need a picture of your object to complete the data fields for the user.
               Using image recognition allow the seller to buy many minutes to publish his offer.</p>
          </div>
        </div>


        <div class="col s12 m4  ">
          <div class="icon-block">

            <p class="light"></p>
          </div>
        </div>

        <div class="col s12 m4">
          <div class="icon-block">
            <h2 class="center light-blue-text"><i class="material-icons">group</i></h2>
            <h5 class="center">User Experience Improved</h5>

            <p class="light">Using our price recomandation brings fairness to the selling process ! 
              The seller associate a fair price to his product and the buyer will be noticed when the suggestion is used. That is the start point of the trust relationship between the two actors.
            </p>
          </div>
        </div>


    </div>
    <br><br>
  </div>

  <footer class="page-footer orange">
    <div class="container">
      <div class="row">
        <div class="col l6 s12">
          <h5 class="white-text">leboncoin</h5>
          <p class="grey-text text-lighten-4">So we work on improving user experience on the website. Anyone who wants to sell his product will just  have to take a picture of it. Then our process will
            automatically complete the different fields. So the user won't loose his time submitting his product. Moreover it adds fairness on the process of selling if the seller 
            uses our algorithm to determine the "right price".
          </p>


        </div>
        <div class="col l3 s12">
          <h5 class="white-text">About us</h5>
          <ul>
            <li><a class="white-text" href="https://www.linkedin.com/in/brieuc-l-h%C3%A9lias-25a064b3/"> Brieuc</a></li>
            <li><a class="white-text" href="https://www.linkedin.com/in/dorian-morel-sapene/"> Dorian</a></li>
            <li><a class="white-text" href="https://www.linkedin.com/in/kenza-s-84b090b4/"> Kenza</a></li>
            <li><a class="white-text" href="https://www.linkedin.com/in/khaled-faysal-9b4132115/"> Khaled</a></li>
            <li><a class="white-text" href="https://www.linkedin.com/in/saqab-mukhtar-902755a1/"> Saqab</a></li>
            <li><a class="white-text" href="https://www.linkedin.com/in/shamil-gasanov-389493108/"> Shamil</a></li>
          </ul>
        </div>
        <div class="col l3 s12">
          <h5 class="white-text">Connect</h5>
          <ul>
            <li><a class="white-text" href="#!">Link 1</a></li>
            <li><a class="white-text" href="#!">Link 2</a></li>
            <li><a class="white-text" href="#!">Link 3</a></li>
            <li><a class="white-text" href="#!">Link 4</a></li>
          </ul>
        </div>
      </div>
    </div> 
  </footer>


  <!--  Scripts-->
  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="js/materialize.js"></script>
  <script src="js/init.js"></script> 
  <script src="js/upload_img.js"></script> 
  <script>
	function previewFile() {
	  var preview = document.querySelector('img');
	  var file    = document.querySelector('input[type=file]').files[0];
	  var reader  = new FileReader();

	  reader.onloadend = function () {
		preview.src = reader.result;
	  }

	  if (file) {
		reader.readAsDataURL(file);
	  } else {
		preview.src = "";
	  }
  }
  // ************************ Drag and drop ***************** //
let dropArea = document.getElementById("drop-area")

// Prevent default drag behaviors
;['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
  dropArea.addEventListener(eventName, preventDefaults, false)   
  document.body.addEventListener(eventName, preventDefaults, false)
})

// Highlight drop area when item is dragged over it
;['dragenter', 'dragover'].forEach(eventName => {
  dropArea.addEventListener(eventName, highlight, false)
})

;['dragleave', 'drop'].forEach(eventName => {
  dropArea.addEventListener(eventName, unhighlight, false)
})

// Handle dropped files
dropArea.addEventListener('drop', handleDrop, false)

function preventDefaults (e) {
  e.preventDefault()
  e.stopPropagation()
}

function highlight(e) {
  dropArea.classList.add('highlight')
}

function unhighlight(e) {
  dropArea.classList.remove('active')
}

function handleDrop(e) {
  var dt = e.dataTransfer
  var files = dt.files

  handleFiles(files)
}

let uploadProgress = []
let progressBar = document.getElementById('progress-bar')

function initializeProgress(numFiles) {
  progressBar.value = 0
  uploadProgress = []

  for(let i = numFiles; i > 0; i--) {
    uploadProgress.push(0)
  }
}

function updateProgress(fileNumber, percent) {
  uploadProgress[fileNumber] = percent
  let total = uploadProgress.reduce((tot, curr) => tot + curr, 0) / uploadProgress.length
  console.debug('update', fileNumber, percent, total)
  progressBar.value = total
}

function handleFiles(files) {
  files = [...files]
  console.log(files.length+ " avant\n")
  initializeProgress(files.length)
  console.log(files.length+ " apres\n")
  files.forEach(uploadFile)
  files.forEach(previewFile)
}

function previewFile(file) {
  let reader = new FileReader()
  reader.readAsDataURL(file)
  reader.onloadend = function() {
    let img = document.createElement('img')
    img.src = reader.result
    document.getElementById('gallery').appendChild(img)
  }
}

function uploadFile(file, i) {
  var url = 'https://api.cloudinary.com/v1_1/joezim007/image/upload'
  var xhr = new XMLHttpRequest()
  var formData = new FormData()
  xhr.open('POST', url, true)
  xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest')

  // Update progress (can be used to show progress indicator)
  xhr.upload.addEventListener("progress", function(e) {
    updateProgress(i, (e.loaded * 100.0 / e.total) || 100)
  })

  xhr.addEventListener('readystatechange', function(e) {
    if (xhr.readyState == 4 && xhr.status == 200) {
      updateProgress(i, 100) // <- Add this
    }
    else if (xhr.readyState == 4 && xhr.status != 200) {
      // Error. Inform the user
    }
  })

  formData.append('upload_preset', 'ujpu6gyk')
  formData.append('file', file)
  xhr.send(formData)
}
  
	</script>
  </body>
</html>
